class FloatingHeader extends HTMLElement{#translations;#lan={inter:"ZWISCHEN",rail:"RAIL"};#inter;#rail;#expanded=false;#updateSize(){if(!this.#expanded){var f=$("#background").css("right"),e=clamp(document.documentElement.scrollTop/300,0,1),n=$("floating-header #wrapper")[0].getBoundingClientRect(),t=$(window).width()-n.left-n.width-15,i=$(window).height()-n.top-n.height-15,r=t-(t-15)*e,u=i-(i-15)*e;(r==null||r>t)&&(r=t);(u==null||u>i)&&(u=i);$("#background").css("right",r+"px").css("bottom",u+"px");document.documentElement.scrollTop>=300&&f!="15px"?transitionIn():document.documentElement.scrollTop<300&&f=="15px"&&transitionOut(null,()=>{})}}constructor(){$.get("src/data/translations.json",n=>{this.#translations=n});super();window.floatingHeader=this}onCreation

    connectedCallback(){fetch("/src/html/floatingHeader.html").then(n=>n.text()).then(n=>{this.innerHTML=n,this.#lan=this.#translations?this.#translations[this.getAttribute("lan")??"Deutschland"]:this.#lan,$("floating-header #inter").text(this.#lan.inter),$("floating-header #rail").text(this.#lan.rail),this.#inter=new TextScramble($("floating-header #inter")[0]),this.#rail=new TextScramble($("floating-header #rail")[0]),this.expanded=this.getAttribute("expand")=="true"?!0:!1,this.#updateSize(),new ResizeObserver(()=>{this.#updateSize()}).observe($("floating-header #wrapper")[0]),window.addEventListener("scroll",()=>{this.#updateSize()}),window.addEventListener("resize",()=>{this.#updateSize()}),this.onCreation!=null&&this.onCreation()})}attributeChangedCallback(){var t=this.#translations?this.#translations[this.getAttribute("lan")??"Deutschland"]:this.#lan,n=this.getAttribute("expand")=="true"?!0:!1;n!=this.#expanded&&(n?(this.#expanded=n,anime({targets:"#background",left:0,right:0,top:0,bottom:0,easing:"easeInOutCubic",duration:500,complete:()=>{$("#map-container").css("visibility","hidden")}})):($("#map-container").css("visibility",""),anime({targets:"#background",left:"15px",right:"15px",top:"15px",bottom:"15px",easing:"easeInOutCubic",duration:500,complete:()=>{$("#background").css("left","").css("top",""),this.#expanded=n,this.#updateSize()}})));this.#inter!=null&&this.#rail!=null&&t!=this.#lan&&(this.#lan=t,this.#inter.setText(this.#lan.inter),this.#rail.setText(this.#lan.rail))}get expanded(){return this.#expanded}set expanded(n){this.setAttribute("expand",n)}set expandedSilent(n){n?$("#map-container").css("visibility","hidden"):$("#map-container").css("visibility","");this.#expanded=n;this.setAttribute("expand",n)}set language(n){this.setAttribute("lan",n)}static get observedAttributes(){return["lan","expand"]}}class TextScramble{constructor(n){this.el=n;this.chars="ABCDEFGHIJKLMNOPQRSTUVWXYZ";this.update=this.update.bind(this)}setText(n){const t=this.el.innerText,i=Math.max(t.length,n.length),r=new Promise(n=>this.resolve=n);this.queue=[];for(let r=0;r<i;r++){const u=t[r]||"",f=n[r]||"",i=Math.floor(Math.random()*40),e=i+Math.floor(Math.random()*40);this.queue.push({from:u,to:f,start:i,end:e})}return cancelAnimationFrame(this.frameRequest),this.frame=0,this.update(),r}update(){let n="",t=0;for(let i=0,r=this.queue.length;i<r;i++){let{from:u,to:f,start:e,end:o,char:r}=this.queue[i];this.frame>=o?(t++,n+=f):this.frame>=e?((!r||Math.random()<.28)&&(r=this.randomChar(),this.queue[i].char=r),n+=`<span class="dud">${r}</span>`):n+=u}this.el.innerHTML=n;t===this.queue.length?this.resolve():(this.frameRequest=requestAnimationFrame(this.update),this.frame++)}randomChar(){return this.chars[Math.floor(Math.random()*this.chars.length)]}}customElements.define("floating-header",FloatingHeader)